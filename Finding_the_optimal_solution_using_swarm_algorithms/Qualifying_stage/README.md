# Автоматическая калибровка камеры дрона с использованием ArUco-маркеров

## Описание 

Скрипт [auto_calibrate_camera.py](./auto_calibrate_camera.py) предназначен для автоматической калибровки камеры дрона в симуляционной среде, где нет возможности использовать традиционный метод калибровки с шахматной доской.

## Основная идея

Поскольку в симуляторе отсутствует возможность загрузить шахматное поле для стандартной калибровки камеры, используется альтернативный подход:

1. Дрон подлетает к заранее известному ArUco-маркеру, координаты которого точно определены в симуляторе
2. Камера дрона фиксирует маркер и определяет его положение
3. Алгоритм автоматически подбирает параметры камеры (`camera_matrix` и `dist_coeffs`), чтобы минимизировать расхождение между:
   - Известными реальными координатами маркера
   - Координатами, вычисленными камерой дрона

## Ключевые особенности

- **Адаптивная настройка параметров**: Скрипт автоматически корректирует параметры камеры для минимизации ошибки
- **Визуализация процесса**: Реальное положение маркера отображается с осями координат
- **Автоматическое завершение**: Процесс останавливается при достижении заданной точности (ошибка < 0.001 по осям X и Y)
- **Сохранение результатов**: Оптимальные параметры камеры сохраняются в файл `optimized_camera_params.yml`

## Как это работает

1. Дрон взлетает и занимает позицию перед маркером
2. Для каждого кадра:
   - Обнаруживается ArUco-маркер
   - Вычисляется текущая ошибка позиционирования
   - Параметры камеры корректируются для уменьшения ошибки
   - Процесс повторяется до достижения нужной точности


## Выходные данные

После успешной калибровки создается файл `optimized_camera_params.yml` с оптимальными параметрами:
- Матрица камеры (mtx)
- Коэффициенты дисторсии (dist)

## Примечания

- Для работы требуется, чтобы дрон мог стабильно удерживать позицию перед маркером
- Начальные параметры камеры могут быть скорректированы в коде при необходимости
- Точность калибровки можно регулировать через параметр `precision_threshold`








3 30 
Финальные усредненные координаты маркеров:
Маркер 71: x=-0.4343, y=3.6158
Маркер 52: x=-2.9430, y=2.1211
Маркер 24: x=2.6828, y=2.3788
Маркер 63: x=-0.8269, y=-0.3567
Маркер 35: x=2.7816, y=-1.4306
Маркер 16: x=-3.3587, y=-2.1834
Маркер 47: x=2.0460, y=-3.4310



10 100
Финальные усредненные координаты маркеров:
Маркер 71: x=-0.2641, y=3.7241
Маркер 52: x=-3.0520, y=2.0362
Маркер 24: x=2.7524, y=2.3678
Маркер 63: x=-0.9637, y=-0.4034
Маркер 35: x=2.9142, y=-1.4695
Маркер 16: x=-3.4456, y=-2.1902
Маркер 47: x=1.9883, y=-3.3804